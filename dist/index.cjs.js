"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("react/jsx-runtime"),v=require("react"),w=require("@auth0/auth0-react"),N=({variant:a="primary",size:t="medium",disabled:n=!1,loading:l=!1,onClick:r,type:s="button",className:i="",children:c})=>{const h="medbai-button",d=`medbai-button--${a}`,m=`medbai-button--${t}`,u=[h,d,m,n?"medbai-button--disabled":"",i].filter(Boolean).join(" ");return e.jsxs("button",{type:s,className:u,disabled:n||l,onClick:r,children:[l&&e.jsx("div",{className:"medbai-spinner medbai-spinner--small"}),c]})},S=({label:a,required:t=!1,error:n,help:l,disabled:r=!1,id:s,children:i,errorId:c,helpId:h})=>{const d=`${s}-label`,m=c||`${s}-error`,g=h||`${s}-help`;return e.jsxs("div",{className:"medbai-form-group",children:[e.jsx("label",{htmlFor:s,id:d,className:`medbai-form-label ${t?"medbai-form-label--required":""}`,children:a}),i,n&&e.jsx("div",{id:m,className:"medbai-form-error",role:"alert","aria-live":"polite",children:n}),l&&!n&&e.jsx("div",{id:g,className:"medbai-form-help",children:l})]})},x=({type:a="text",value:t,onChange:n,placeholder:l,autoComplete:r,maxLength:s,minLength:i,pattern:c,error:h,disabled:d,id:m,...g})=>{const u=["medbai-form-input",h?"medbai-form-input--error":""].filter(Boolean).join(" ");return e.jsx(S,{...g,id:m,error:h,disabled:d,children:e.jsx("input",{id:m,type:a,value:t,onChange:p=>n(p.target.value),placeholder:l,autoComplete:r,maxLength:s,minLength:i,pattern:c,disabled:d,className:u,"aria-invalid":!!h,"aria-describedby":[h?`${m}-error`:"",g.help?`${m}-help`:""].filter(Boolean).join(" ")||void 0})})},L=({type:a="info",message:t,onRetry:n,retryLoading:l=!1,dismissible:r=!1,onDismiss:s,className:i=""})=>{const c=()=>{switch(a){case"info":return"ℹ️";case"warning":return"⚠️";case"error":return"❌";case"success":return"✅";default:return"ℹ️"}};return e.jsx("div",{className:`medbai-status-banner medbai-status-banner--${a} ${i}`,role:"alert",children:e.jsxs("div",{className:"medbai-status-banner-content",children:[e.jsx("span",{className:"medbai-status-banner-icon","aria-hidden":"true",children:c()}),e.jsx("span",{className:"medbai-status-banner-message",children:t}),e.jsxs("div",{className:"medbai-status-banner-actions",children:[n&&e.jsx("button",{onClick:n,disabled:l,className:"medbai-button medbai-button--small medbai-button--secondary","aria-label":"Retry action",children:l?"Retrying...":"Retry"}),r&&s&&e.jsx("button",{onClick:s,className:"medbai-button medbai-button--small medbai-button--secondary","aria-label":"Dismiss message",children:"✕"})]})]})})},A=({data:a,columns:t,emptyMessage:n="No data available",loading:l=!1,sortable:r=!1,onSort:s,className:i=""})=>{const[c,h]=v.useState(null),[d,m]=v.useState("asc"),g=o=>{if(!r)return;const b=c===o&&d==="asc"?"desc":"asc";h(o),m(b),s?.(o,b)},u=v.useMemo(()=>!c||!r?a:[...a].sort((o,b)=>{const f=o[c],y=b[c];if(f===y)return 0;const T=f<y?-1:1;return d==="asc"?T:-T}),[a,c,d,r]),p=(o,b)=>o.render?o.render(b[o.key],b):b[o.key];return l?e.jsx("div",{className:`medbai-table-container ${i}`,children:e.jsxs("div",{className:"medbai-table-empty",children:[e.jsx("div",{className:"medbai-spinner"}),e.jsx("span",{style:{marginLeft:"8px"},children:"Loading..."})]})}):u.length===0?e.jsx("div",{className:`medbai-table-container ${i}`,children:e.jsx("div",{className:"medbai-table-empty",children:n})}):e.jsx("div",{className:`medbai-table-container ${i}`,children:e.jsxs("table",{className:"medbai-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:t.map(o=>e.jsxs("th",{className:`medbai-table-header ${o.sortable?"medbai-table-header--sortable":""} ${o.className||""}`,onClick:()=>o.sortable&&g(String(o.key)),children:[o.label,c===o.key&&e.jsx("span",{style:{marginLeft:"4px"},children:d==="asc"?"↑":"↓"})]},String(o.key)))})}),e.jsx("tbody",{children:u.map((o,b)=>e.jsx("tr",{className:"medbai-table-row",children:t.map(f=>e.jsx("td",{className:`medbai-table-cell ${f.className||""}`,children:p(f,o)},String(f.key)))},b))})]})})};function C(a){return a?a.replace(/[<>]/g,"").replace(/[&"']/g,"").replace(/[/\\]/g,"").trim():""}function P(a){return a?a.replace(/[<>]/g,"").replace(/[&"']/g,"").replace(/[/\\]/g,"").replace(/[^\w\s-]/g,"").trim():""}function k(a){return a?a.replace(/[<>]/g,"").replace(/[&"']/g,"").replace(/[/\\]/g,"").replace(/[^\w\s.-]/g,"").trim():""}function $(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):""}const E=({onSubmit:a,disabled:t=!1,loading:n=!1,className:l=""})=>{const[r,s]=v.useState({name:"",title:""}),[i,c]=v.useState({}),h=()=>{const u={};return r.name&&!r.name.trim()&&(u.name="Name cannot be empty"),c(u),Object.keys(u).length===0},d=u=>{if(u.preventDefault(),!h())return;const p={...r.name&&{name:P(r.name.trim())},...r.title&&{title:k(r.title.trim())}};a(p)},m=u=>p=>{s(o=>({...o,[u]:p})),i[u]&&c(o=>({...o,[u]:void 0}))},g=t||n;return e.jsxs("form",{onSubmit:d,className:`medbai-form ${l}`,children:[e.jsx(x,{id:"name",label:"Name",value:r.name||"",onChange:m("name"),placeholder:"Enter your name (optional if authenticated)",disabled:t||n,error:i.name,help:"Optional - will use authenticated user name if available"}),e.jsx(x,{id:"title",label:"Title",value:r.title||"",onChange:m("title"),placeholder:"Enter your title (optional)",disabled:t||n,help:"Optional title or position"}),e.jsx(N,{type:"submit",disabled:g,loading:n,className:"medbai-button--primary",children:n?"Submitting...":"Submit"})]})},H=({data:a,className:t=""})=>{const n=v.useMemo(()=>[...a].sort((s,i)=>i.count!==s.count?i.count-s.count:s.name.localeCompare(i.name)),[a]),l=s=>{try{return new Date(s).toLocaleString()}catch{return"Invalid date"}},r=[{key:"name",label:"Name",render:(s,i)=>e.jsxs("div",{children:[i.title&&e.jsx("span",{className:"medbai-text-muted",style:{marginRight:"4px"},children:i.title}),e.jsx("span",{className:"medbai-text-primary",children:i.name})]})},{key:"count",label:"Count",render:s=>e.jsx("div",{className:"medbai-text-center",style:{fontWeight:"600",color:"var(--medbai-primary)"},children:s})},{key:"lastHelloAt",label:"Last Hello At",render:s=>e.jsx("div",{className:"medbai-text-muted",style:{fontSize:"var(--medbai-font-size-sm)"},children:l(s)})}];return e.jsx(A,{data:n,columns:r,emptyMessage:"No statistics available yet. Submit a greeting to get started!",className:t})};function _(){if(typeof window>"u")return!1;const a=window.location.origin;return!!(a.startsWith("https://")||a.startsWith("http://localhost")||a.startsWith("http://127.0.0.1"))}const D=({children:a,config:t})=>_()?e.jsx(w.Auth0Provider,{domain:t.domain,clientId:t.clientId,authorizationParams:{redirect_uri:t.redirectUri||window.location.origin+"/callback",audience:t.audience},cacheLocation:"localstorage",useRefreshTokens:!0,children:a}):(console.warn("⚠️  Auth0 disabled: App is running on HTTP (non-localhost). Auth0 requires HTTPS or localhost. The app will work without authentication."),e.jsx(e.Fragment,{children:a}));function F(){if(typeof window>"u")return!1;const a=window.location.origin;return a.startsWith("https://")||a.startsWith("http://localhost")||a.startsWith("http://127.0.0.1")}function j(){if(!F())return{isAuthenticated:!1,isLoading:!1,user:void 0,error:void 0,getAccessTokenSilently:async()=>{throw new Error("Auth0 is not available on HTTP (non-localhost). Use HTTPS or localhost.")},getAccessTokenWithPopup:async()=>{throw new Error("Auth0 is not available on HTTP (non-localhost). Use HTTPS or localhost.")},getIdTokenClaims:async()=>{},loginWithRedirect:()=>{console.warn("Auth0 login is not available on HTTP (non-localhost). Use HTTPS or localhost.")},loginWithPopup:async()=>{throw new Error("Auth0 is not available on HTTP (non-localhost). Use HTTPS or localhost.")},logout:()=>{console.warn("Auth0 logout is not available on HTTP (non-localhost). Use HTTPS or localhost.")},handleRedirectCallback:async()=>{throw new Error("Auth0 is not available on HTTP (non-localhost). Use HTTPS or localhost.")}};try{const a=w.useAuth0();return{...a,user:a.user}}catch{return console.warn("Auth0Provider not found, returning mock context"),{isAuthenticated:!1,isLoading:!1,user:void 0,error:void 0,getAccessTokenSilently:async()=>{throw new Error("Auth0Provider is not available")},getAccessTokenWithPopup:async()=>{throw new Error("Auth0Provider is not available")},getIdTokenClaims:async()=>{},loginWithRedirect:()=>{console.warn("Auth0Provider is not available")},loginWithPopup:async()=>{throw new Error("Auth0Provider is not available")},logout:()=>{console.warn("Auth0Provider is not available")},handleRedirectCallback:async()=>{throw new Error("Auth0Provider is not available")}}}}async function R(a){try{return await a()}catch(t){return console.error("Failed to get access token:",t),null}}const W=()=>{const{isAuthenticated:a,user:t,loginWithRedirect:n,logout:l}=j();if(a&&t){const r=t.name||t.nickname||t.email||"User";return e.jsxs("div",{className:"auth-button",children:[e.jsxs("div",{className:"auth-button__user-info",children:[t.picture&&e.jsx("img",{src:t.picture,alt:r,className:"auth-button__avatar"}),e.jsxs("div",{className:"auth-button__user-details",children:[e.jsx("span",{className:"auth-button__user-name",children:r}),t.email&&e.jsx("span",{className:"auth-button__user-email",children:t.email})]})]}),e.jsx("button",{className:"auth-button__logout",onClick:()=>l({logoutParams:{returnTo:window.location.origin}}),"aria-label":"Logout",children:"Logout"})]})}return e.jsx("button",{className:"auth-button__login",onClick:()=>n(),"aria-label":"Login",children:"Login"})},z=({children:a,fallback:t=null})=>{const{isAuthenticated:n,isLoading:l}=j();return l?e.jsx("div",{children:"Loading..."}):n?e.jsx(e.Fragment,{children:a}):e.jsx(e.Fragment,{children:t})};class I{constructor(t="info",n=!1){this.level=t,this.isDevelopment=n}shouldLog(t){const n={debug:0,info:1,warn:2,error:3};return n[t]>=n[this.level]}formatMessage(t,n,l){const r=new Date().toISOString(),s={level:t,message:n,timestamp:r,context:l};if(this.isDevelopment){const i=t==="debug"?"log":t,c=`[${r}] [${t.toUpperCase()}]`;return console[i](`${c} ${n}`,l||""),n}return JSON.stringify(s)}debug(t,n){this.shouldLog("debug")&&this.formatMessage("debug",t,n)}info(t,n){this.shouldLog("info")&&this.formatMessage("info",t,n)}warn(t,n){this.shouldLog("warn")&&this.formatMessage("warn",t,n)}error(t,n){this.shouldLog("error")&&this.formatMessage("error",t,n)}setLevel(t){this.level=t}}const M=new I(process.env.REACT_APP_LOG_LEVEL||"info",process.env.NODE_ENV==="development");exports.AuthButton=W;exports.AuthProvider=D;exports.Button=N;exports.FormField=S;exports.GreetingForm=E;exports.Input=x;exports.ProtectedRoute=z;exports.StatsTable=H;exports.StatusBanner=L;exports.Table=A;exports.getAccessToken=R;exports.logger=M;exports.sanitizeHTML=$;exports.sanitizeName=P;exports.sanitizeString=C;exports.sanitizeTitle=k;exports.useAuth0=j;
